<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Suministros{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Grenze:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    {% block page_styles %}{% endblock %}
</head>
<body class="bg-gray-900 text-gray-200 {% block body_class %}{% endblock %}">

    <nav class="bg-gray-800 text-white p-4">
        <div class="container mx-auto flex justify-between items-center">
            <a class="text-xl font-bold" href="{{ url_for('auth.root') }}">Suministros CNCV</a>
            <div class="block lg:hidden">
                <button id="nav-toggle" class="flex items-center px-3 py-2 border rounded text-gray-200 border-gray-400 hover:text-white hover:border-white">
                    <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg>
                </button>
            </div>
            <div id="nav-content" class="w-full hidden lg:flex lg:items-center lg:w-auto">
                <ul class="lg:flex-grow lg:flex lg:items-center">
                    {% if g.user %}
                        <li>
                            <a class="block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-white mr-4" href="{{ url_for('inventario.menu_principal') }}">Menú Principal</a>
                        </li>
                        <li>
                            <a class="block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-white mr-4" href="{{ url_for('proveedores.proveedores') }}">Proveedores</a>
                        </li>
                        <li>
                            <a class="block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-white mr-4" href="{{ url_for('inventario.productos') }}">Inventario</a>
                        </li>
                        <li>
                            <a class="block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-white mr-4" href="{{ url_for('reportes.graficas') }}">Gráficos</a>
                        </li>
                        <li>
                            <a class="block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-white" href="{{ url_for('contabilidad.balance') }}">Contabilidad</a>
                        </li>
                    {% endif %}
                </ul>
                <ul class="lg:flex lg:items-center">
                    {% if g.user %}
                        <li class="mt-4 lg:mt-0">
                            <span class="text-gray-400 mr-4">
                                Bienvenido, {{ g.user.username }}
                            </span>
                        </li>
                        <li>
                            <a class="block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-white" href="{{ url_for('auth.logout') }}">Logout</a>
                        </li>
                    {% else %}
                        <li>
                            <a class="block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-white mr-4" href="{{ url_for('auth.login') }}">Login</a>
                        </li>
                        <li>
                            <a class="block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-white" href="{{ url_for('auth.registro') }}">Registro</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="fixed top-5 right-5 w-full max-w-xs z-50">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    {% set color_map = {
                        'success': 'bg-green-100 border-green-400 text-green-700',
                        'danger': 'bg-red-100 border-red-400 text-red-700',
                        'warning': 'bg-yellow-100 border-yellow-400 text-yellow-700',
                        'info': 'bg-blue-100 border-blue-400 text-blue-700'
                    } %}
                    {% set alert_classes = color_map.get(category, 'bg-gray-100 border-gray-400 text-gray-700') %}
                    <div role="alert" class="alert-dismissible p-4 rounded-lg shadow-md mb-4 flex justify-between items-start border {{ alert_classes }}">
                        <div class="flex items-start">
                            <p>{{ message }}</p>
                        </div>
                        <button type="button" class="ml-4 p-1.5 -mt-1.5 -mr-1.5" onclick="this.parentElement.style.display='none';">
                            <span class="sr-only">Dismiss</span>
                            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>

    <div class="container mx-auto mt-4 px-4">
        {% block content %}{% endblock %}
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Auto-ocultar alertas
            setTimeout(() => {
                const alerts = document.querySelectorAll(".alert-dismissible");
                alerts.forEach(alert => {
                    alert.style.display = 'none';
                });
            }, 5000);

            // Toggle mobile nav
            document.getElementById('nav-toggle').addEventListener('click', function() {
                document.getElementById('nav-content').classList.toggle('hidden');
            });
        });
    </script>
    {% block page_scripts %}{% endblock %}
</body>
</html>
