{% extends "base.html" %}
{% block title %}Mis Pedidos{% endblock %}
{% block page_styles %}
<style>
    table { width: 100%; table-layout: fixed; border-collapse: collapse; }
    th, td { padding: 10px; text-align: center; border: 1px solid rgba(255, 255, 255, 0.2); }
    th { background-color: rgba(0, 0, 0, 0.8); text-transform: uppercase; }
    td { background-color: #333; color: white; border-bottom: 1px solid #444; }
    thead th { position: sticky; top: 0; z-index: 10; }
    .material-symbols-outlined { font-size: 34px; background-color: transparent; color: white; }
    .btn-neon-r { background: transparent; color: red; border: 1px solid white; padding: 5px 10px; cursor: pointer; border-radius: 5px; transition: 0.3s; }
    .btn-neon-r:hover { color: black; box-shadow: 0 0 5px red; }
</style>
{% endblock %}

{% block content %}
<main class="container py-5">
    <div class="d-flex align-items-center mb-4">
        <a class="material-symbols-outlined" href="{{ url_for('inventario.menu_cliente') }}" aria-label="Volver al menú del cliente">
            arrow_back
        </a>
        <h1 class="ms-3 titlewhiteN mb-0">Mis Pedidos</h1>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr class="titlewhiteN">
                    <th>Producto</th>
                    <th>Cantidad</th>
                    <th>Precio Unitario (€)</th>
                    <th>Total (€)</th>
                    <th>Estado</th>
                    <th>Fecha</th>
                    <th>Opciones</th>
                </tr>
            </thead>
            <tbody>
                {% for pedido in pedidos %}
                    <tr>
                        <td>{{ pedido.producto.modelo }}</td>
                        <td>{{ pedido.cantidad }}</td>
                        <td>{{ pedido.precio_unitario }}</td>
                        <td>{{ pedido.total }}</td>
                        <td>{{ pedido.estado }}</td>
                        <td>{{ pedido.fecha.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                        <td>
                            {% if pedido.estado == "Pendiente" %}
                                <form action="{{ url_for('inventario.cancelar_pedido', pedido_id=pedido.id) }}" method="POST" onsubmit="return confirm('¿Estás seguro de que deseas cancelar este pedido?');">
                                    {{ csrf_token() }}
                                    <button type="submit" class="btn-neon-r btn-sm btn-outline-light titlewhite" aria-label="Cancelar {{ pedido.producto.nombre }}">
                                        Cancelar
                                    </button>
                                </form>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</main>
{% endblock %}
